ch
恢复状态为removed的内置硬盘
 客户除尘不小心碰到P6-550的一块内置硬盘(估计是下电后，有人拔出来看，插回去时没有插好)！ 导致一部分FS无法使用，差点丢失数据! 到达现场: lsvg -p rootvg hdisk0 removed hdisk1 available lspv hdisk1 lsdev -Cc disk hdisk1 本以为是正常硬盘损坏，且有部分FS没有做mirror，告知客户，有可能丢失数据! 进机房,突然发现hdisk0的物理位置(lscfg -vl hdisk0)是松掉的，激动啊！！// 邱丽斌干活认真仔细啊。。。如果不仔细的话，直接换盘，数据就没了! 查看errpt log,根据时间询问客户得知，那天集成商帮他们除尘......此处省略1000字.... 让客户做mksysb备份系统，然后尝试恢复! 恢复过程: rmdev -l hdisk0 //(扫盲:一般参数都会跟dl,l表示把硬盘职位define,d表示把ODM库信息删除，显然此时我们没必要删除ODM库信息) cfgmgr -vl hdisk0 chpv -va hdisk0 //(va 使物理卷对于逻辑I/O可用, vr反之) lsvg -p rootvg hdisk0 available hdisk1 available lspv hdisk0 hdisk1 lsdev -Cc disk hdisk0 hdisk1 此时数据已经安全，hdisk0的fs已经可以正常mount 但此时VG的lv基本上都为stale的状态,sync一下可以了! syncvg -p hdisk04 hdisk05 lsvg -l rootvg //检查所有lv state全为sync就OK了，期间可以用lsvg rootvg检查状态为stale的数量，以估计时间! 建议可以做完整mirror,smitty mklvcopy 把没有镜像的那部分挨着做。。。。。 Note:如果是正常的硬盘损坏，硬盘状态为removed,在确定没有数据丢失的情况下，直接换掉! 如果有数据丢失且没备份，可以用此方法尝试!做之前一定要让客户系统备份！ 