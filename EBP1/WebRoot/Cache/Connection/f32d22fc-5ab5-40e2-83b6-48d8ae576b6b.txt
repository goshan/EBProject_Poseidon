ch
目前DS8K使用一个RAID对应一个EXTPOOL划盘方式的一些经验和想法
 想来目前绝大多数使用DS8K的客户应该是使用一个RAID对应一个EXTPOOL，划盘的时候使用以下命令格式。 mkfbvol -extpool P0 -cap 70 -name P11_lp1_#h 1000 mkfbvol -extpool P1 -cap 70 -name P11_lp1_#h 1100 mkfbvol -extpool P2 -cap 70 -name P11_lp1_#h 1001 mkfbvol -extpool P3 -cap 70 -name P11_lp1_#h 1101 这种划盘方式，从不同的RAID组里划出盘，同时由单双数控制器分别控制2快盘，以达到性能优化。 用此种方式在农行长期的使用中我发现有个问题需要注意。 上面的命令中在AIX中认到的盘是怎么编号的？ 我们第一反应的VPATH0=1000，VPATH1=1100，VPATH2=1001，VPATH3=1101 尔事实情况是 VPATH0=1000,VPATH1=1001,VPATH2=1100,VPATH3=1101 看似这样也没上面问题，对我们做VG并没有影响，其实不是这样。 我们曾今有台DS8K中了63版本中很有名的BUG，就是定期会CLUSTER重启，内存溢出（大家应该还有印象） CLUSTER自动重启后我们需要每周对控制器的内存PIN进行检查，超过一定值需要手动过重启来避免自动重启造成的短暂I/O访问中断。在过程中我们发现其中的一个控制器PIN值得涨幅明显快于另一个，这是为什么？ 答案是二个控制器的负载不均衡。那为什么按照0和1的划盘方式会导致二控制负载不均衡，问题就是出在VPATH认盘的规律上。 农行使用的数据库是SYBASE，通常会有2个VG组成，SYSTVG 和DATAVG，据客户那里了解，systvg是放类似索引文件，datavg是放具体数据，systvg一般只需要几块盘，而datavg则需要几十快盘。 我们以4块盘一组应用为例，4个应用16块盘。我们建立了0控制器上8块盘，1控制器上8块盘。从AIX上认到的每4块盘都是0控制器是VPATH0和1，1控制器是VPATH2和3。 我们开始建立VG，4个应用的VPATH0都顺手建立了SYSTVG，VPATH1-3都建立了DATAVG.问题来了。 就是客户所有应用的VPATH0都建立了systvg，就是所有的SYSTVG都是跑在控制器0上，而没有做到2个控制器的均衡。而据客户所说systvg对于I/OPS的要求还要高于DATAVG。 所以我们在划完盘后做VG之前应该再仔细规划下建立VG所使用的VPATH。 我建议在VPATH号无法改成VPATH0=1000，VPATH1=1100，VPATH2=1001，VPATH3=1101的前提下。 使用一组应用用VPATH0建SYSTVG，一组应用使用VPATH3建立SYSTVG来达到较为均衡。 另求方法可以使AIX认到的盘可以达到VPATH0=1000，VPATH1=1100，VPATH2=1001，VPATH3=1101的效果。 